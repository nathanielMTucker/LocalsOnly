{"version":3,"sources":["Components/Picture.jsx","Components/Results.jsx","img/LocalsOnly.png","Components/MapContainer.jsx","Components/ResultsCard.jsx","Pages/Results.jsx"],"names":["Picture","id","publicId","IOM","require","StarRating","unrated","rating","className","tmp","isHalf","Math","floor","ratingElm","i","push","map","star","index","Results","loading","children","alt","src","DEF_CENTER","lat","lng","GoogleApiWrapper","apiKey","API_KEY","props","useEffect","initialCenter","geo","undefined","markers","length","forEach","marker","parseFloat","google","zoom","center","containerStyle","style","borderRadius","m","position","handleMarkers","ResultsCard","Price","price","Array","keys","_","to","image","url","preset","name","reviewCount","hours","isClosed","from","description","dayOfWeek","compose","withUser","withRouter","user","search","location","madeSearch","setMadeSearch","useState","items","setItems","setLoading","offset","setOffset","limit","getData","useCallback","a","queryString","parse","what","where","axios","get","then","data","after","currentItems","catch","err","console","error","message","NoItemsToDisplay","DisplayItems","today","Date","getDay","results","filter","post","isLocalTo","local","_id","address","images","cloudName","secure","upload_preset","onClick","e","preventDefault","log","MapContainer","height","width","item"],"mappings":"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","file":"static/js/8.f5d74702.chunk.js","sourcesContent":["import React from 'react'\nimport {Image} from 'cloudinary-react';\n\nconst Picture = ({id}) => {\n    \n    return (\n        <Image publicId={id}></Image>\n    )\n}\n\nexport default Picture;","import React from 'react'\r\nconst IOM = require('../img/LocalsOnly.png')\r\nconst Results = ({loading, children, className})=> {\r\n    return (\r\n        <div className={className}>\r\n            \r\n            {loading? <div className=\"loading has-text-centered\">\r\n                <div className=\"animate__slower animate__animated animate__pulse animate__infinite\"><img alt=\"LocalsOnly\" src={IOM}></img></div>\r\n                <p>Wait while we search</p>\r\n            </div>:\r\n            children}\r\n        </div>\r\n    )\r\n}\r\n\r\nconst StarRating = ({rating, className}) => {\r\n    \r\n    const tmp = rating - 0.5;\r\n    let isHalf = false;\r\n    if(tmp === Math.floor(rating)){\r\n        isHalf = true;\r\n    }\r\n    let unrated;\r\n    if(isHalf){\r\n        unrated = 4 - tmp;\r\n        rating = rating - 1;\r\n    }else{\r\n        unrated = 5 - rating;\r\n    }\r\n    \r\n    const ratingElm = [];\r\n    \r\n    for(let i = 0; i < rating; i++) ratingElm.push(\"fas fa-star\")\r\n    \r\n    if(isHalf){\r\n        ratingElm.push(\"fas fa-star-half-alt\")\r\n    }\r\n    \r\n    for(let i = 0; i < unrated; i++) ratingElm.push(\"far fa-star\")\r\n    \r\n    return (<div className={className}>\r\n        {\r\n            ratingElm.map((star, index)=>\r\n            <i key={index} className={`${star} has-text-success`}/>\r\n        )\r\n        }\r\n    </div>)\r\n}\r\n\r\nexport default Results;\r\nexport {\r\n    StarRating\r\n};","export default __webpack_public_path__ + \"static/media/LocalsOnly.3121d9ef.png\";","import React, {useEffect} from 'react'\r\nimport {Map, Marker, GoogleApiWrapper} from 'google-maps-react';\r\nimport {API_KEY} from '../globals';\r\nconst DEF_CENTER = {lat: 33.421996, lng: -111.939935};\r\n//let MAP_ID = 2510fbdecdd41873;\r\n\r\nexport default GoogleApiWrapper({\r\n    apiKey: API_KEY\r\n  })( props =>{\r\n\r\n    useEffect(()=>{\r\n        \r\n    },[])\r\n    const initialCenter=()=>{\r\n        let geo = DEF_CENTER \r\n      \r\n        if( props.markers !== undefined && props.markers[0] !== undefined && props.markers[0] !== null && props.markers[0].lat !== undefined){\r\n            if(props.markers.length > 1){\r\n                let lat = 0\r\n                let lng = 0\r\n                props.markers.forEach(marker=>{\r\n                   \r\n                    lat += parseFloat(marker.lat)\r\n                    lng += parseFloat(marker.lng)\r\n                })\r\n                lat /= props.markers.length;\r\n                lng /= props.markers.length;\r\n                geo = {lat: lat, lng: lng};\r\n            }\r\n            else if(props.markers.length === 1){\r\n                \r\n                geo = props.markers[0]\r\n            }\r\n            \r\n        }\r\n        return geo ;\r\n    }\r\n    \r\n    const handleMarkers= ()=>{\r\n        if(props.markers !== undefined && props.markers[0] !== undefined && props.markers[0] !== null && props.markers[0].lat !== undefined ){\r\n            if(props.markers.length > 1){\r\n                var m = []\r\n                props.markers.forEach((marker, id)=>{\r\n                    m.push(<Marker key={id}  position={{lat:marker.lat ,lng:marker.lng}} />)\r\n                })\r\n                return m\r\n            }else return <Marker position={{ lat:props.markers[0].lat, lng: props.markers[0].lng }}/>\r\n        }\r\n        else return <Marker position={DEF_CENTER}/>\r\n    }\r\n    \r\n    return (\r\n        \r\n        <Map \r\n            google={props.google} \r\n            zoom={props.zoom} \r\n            initialCenter={initialCenter()}\r\n            center={initialCenter()} \r\n            containerStyle={props.style} \r\n            style={{borderRadius:'6px'}}\r\n        >\r\n            {handleMarkers()}\r\n        </Map>\r\n        \r\n    )\r\n})\r\n\r\n","import React  from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport {StarRating} from './Results';\r\n\r\nimport Picture from \"./Picture\";\r\nconst ResultsCard = props => \r\n{\r\n        \r\n    const Price = () =>{\r\n        const { price } = props;\r\n        \r\n        return ([...Array(price).keys()].map((_,index)=>\r\n            <i key={index} className=\"fas fa-dollar-sign has-text-success is-size-5\"/>\r\n        ))\r\n    }\r\n    \r\n    return (\r\n        <Link id={props.id} className=\"box\" to={`/local?id=${props.id}`}>\r\n            <section className=\"columns\">\r\n            <span className=\"column is-4\">\r\n                <figure className=\"image\">\r\n                    {props.image === undefined ? <img src=\"./LocalsOnly.png\" alt=\"LocalsOnly Logo\"/> : <Picture id={props.image.url} preset=\"local_images\"/>}\r\n                </figure>\r\n            </span>\r\n            <article className=\"column\">\r\n                <div className=\"content\">\r\n                    <h1>{props.name}</h1>\r\n                    \r\n                        <div className=\"level-left\">\r\n                            <StarRating className=\"level-item\" rating={props.rating}/>\r\n                            <div className=\"level-item\">\r\n                                {`${props.reviewCount} review${props.reviewCount === 1 ? '' : 's'}`}\r\n                            </div> \r\n                            <div className=\"level-item\">\r\n                                <Price/>\r\n                            </div>\r\n                        </div>\r\n                    <div>{props.hours.isClosed ? <p className=\"has-text-danger\">closed</p> : <p><span className=\"has-text-success\">open</span> {props.hours.from} - {props.hours.to}</p>}</div>\r\n                </div>\r\n                <span className=\"block\">\r\n                    {props.description}\r\n                </span>\r\n            </article>\r\n            </section>\r\n        </Link>\r\n    )\r\n}\r\n\r\nexport default ResultsCard;","import React, { useState, useEffect ,useCallback} from 'react'\r\nimport ResultsCard from '../Components/ResultsCard'\r\nimport queryString from 'query-string'\r\nimport MapContainer from '../Components/MapContainer'\r\nimport Results from '../Components/Results'\r\nimport { Link } from 'react-router-dom'\r\nimport { withUser } from '../User'\r\nimport {compose} from 'recompose'\r\nimport {withRouter} from 'react-router'\r\nimport axios from 'axios'\r\nimport { CloudinaryContext} from 'cloudinary-react'\r\n\r\nconst dayOfWeek = [\r\n    \"sunday\",\r\n    \"monday\",\r\n    \"tuesday\",\r\n    \"wednesday\",\r\n    \"thursday\",\r\n    \"friday\",\r\n    \"saturday\"\r\n]\r\n\r\nexport default compose(withUser, withRouter)(({user, location:{search}, madeSearch, setMadeSearch})=> {\r\n    \r\n    const [items, setItems] = useState([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [offset, setOffset] = useState(null);\r\n    const [limit] = useState(10);\r\n\r\n    \r\n\r\n    const getData = useCallback(async ()=>{\r\n        \r\n        let {what, where} = queryString.parse(search);\r\n        \r\n        await axios.get(`/api/v1/locals?${what ? `what=${what}` : ''}&where=${where}&limit=${limit}${offset ? `&offset=${offset}` : ''}`)\r\n        .then(({data:{data, after}})=>{\r\n            setItems(currentItems=>[...currentItems, ...data])\r\n            setOffset(after)\r\n        })\r\n        .catch(err=>{\r\n            console.error(err)\r\n            setItems([{\r\n                message : \"Unable to connect\"\r\n            }])\r\n        })\r\n\r\n        setLoading(false);\r\n        setMadeSearch(false); \r\n    },[limit, offset, search, setMadeSearch])\r\n    \r\n    useEffect(()=>{  \r\n        getData()\r\n    },[getData, madeSearch])\r\n\r\n\r\n    const NoItemsToDisplay = () =>(\r\n        <div className=\"mx-6 container is-centered\">\r\n                    <div className=\"notification is-info has-text-centered\">\r\n                    <p className=\"subtitle\">\r\n                        We could not find anything!\r\n                    </p>\r\n                    <p>You can help by adding new places to the database <Link className=\"is-text is-focused\" to='/create-local'>here</Link>.</p>\r\n                    </div>\r\n                </div>\r\n        )\r\n\r\n    const DisplayItems = ()=>{\r\n        if (!items)\r\n            return (\r\n                <NoItemsToDisplay/>\r\n            )\r\n            \r\n        if(items[0] !== undefined && items[0].message)\r\n            return (\r\n                <div>\r\n                    <p>{items[0].message}</p>\r\n                </div>\r\n                )\r\n        const today = dayOfWeek[new Date().getDay()]\r\n\r\n        const results = items\r\n            .filter(post=>(user.isLocalTo(post)))\r\n            .map((local, index) => {\r\n                const hours = local.hours[today];\r\n                return <ResultsCard\r\n                        key={index}\r\n                        i={index}\r\n                        id={local._id}\r\n                        name={local.name}\r\n                        description={local.description}\r\n                        rating={local.rating}\r\n                        reviewCount={local.reviewCount}\r\n                        hours={hours}\r\n                        address={local.address}\r\n                        image={local.images.data[0]}\r\n                        price={local.price}\r\n                    />\r\n                }\r\n            )\r\n\r\n        if(results.length <= 0){\r\n            return (\r\n                <NoItemsToDisplay/>\r\n            )\r\n        }\r\n        return results;\r\n    }\r\n    \r\n    const onClickShowMore = e =>{\r\n        e.preventDefault();\r\n        console.log(e);\r\n        getData();\r\n    }\r\n        return (\r\n            <main className=\"\" id=\"results-page\">\r\n                <div className=\"columns pt-4\" >\r\n                    <Results className=\" is-two-fifths column side result-card\" loading={loading}>\r\n                        <CloudinaryContext cloudName={\"dpjlvg7ql\"} secure={false} upload_preset=\"local_images\">\r\n                            {items && <DisplayItems/>}\r\n                        </CloudinaryContext>\r\n                            {offset ? <div className=\"text-has-line my-5 is-clickable\" onClick={onClickShowMore}><span>show more</span></div> : \r\n                                items ? \r\n                                <div className=\"my-5 container is-centered\">\r\n                                    <div className=\"notification is-info has-text-centered\">\r\n                                        <p className=\"subtitle\">\r\n                                            This is all we could find!\r\n                                        </p>\r\n                                        <p>You can help by adding new places to the database <Link className=\"is-text is-focused\" to='/create-local'>here</Link>.</p>\r\n                                    </div>\r\n                                </div> : null\r\n                            }\r\n                    </Results>\r\n                    \r\n                    <div className=\"column is-medium is-hidden-mobile\">\r\n                        {items && <MapContainer style={{height:'89vh', width:'58.5vw'}} zoom={16} markers={items.map(item=>item.geo)}/>}\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        )\r\n    \r\n})"],"sourceRoot":""}