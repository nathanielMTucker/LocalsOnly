(this.webpackJsonplocalsonly=this.webpackJsonplocalsonly||[]).push([[8],{139:function(e,a,t){"use strict";t(1);var s=t(138),n=t(0);a.a=function(e){var a=e.id;return Object(n.jsx)(s.b,{publicId:a})}},143:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var s=t(42);var n=t(52);function c(e){return function(e){if(Array.isArray(e))return Object(s.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(n.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},150:function(e,a,t){"use strict";t(1);var s=t(139),n=t(138),c=t(0);a.a=function(e){var a=e.avatar,t=function(){return Object(c.jsxs)("svg",{viewBox:"0 0 500 500",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(c.jsxs)("g",{id:"default-avatar",clipPath:"url(#clip0)",children:[Object(c.jsx)("g",{id:"background",children:Object(c.jsx)("rect",{id:"avatar-background",width:"500",height:"500",rx:"36",fill:"hsl(".concat(20*Math.floor(18*Math.random()),", 100%, 75%)")})}),Object(c.jsxs)("g",{id:"person",children:[Object(c.jsx)("circle",{id:"avatar-head",cx:"250",cy:"167",r:"115",fill:"white"}),Object(c.jsx)("path",{id:"avatar-body",d:"M475 445C475 414.5 451.295 385.249 409.099 363.683C366.903 342.116 309.674 330 250 330C190.326 330 133.097 342.116 90.901 363.683C48.7053 385.249 25 414.5 25 445L250 445H475Z",fill:"white"})]})]}),Object(c.jsx)("defs",{children:Object(c.jsx)("clipPath",{id:"clip0",children:Object(c.jsx)("rect",{width:"500",height:"500",fill:"white"})})})]})};return Object(c.jsx)("div",{className:"avatar",children:a?Object(c.jsx)(n.a,{cloudName:"dpjlvg7ql",secure:!1,upload_preset:"avatar_images",children:Object(c.jsx)(s.a,{id:a,preset:"avatar_images"})}):Object(c.jsx)(t,{})})}},193:function(e,a,t){"use strict";t.d(a,"a",(function(){return u}));var s=t(12),n=t.n(s),c=t(20),i=t(143),l=t(7),r=t(1),o=t(29),d=t(150),j=t(0),u=Object(o.c)((function(e){var a=e.user,t=e.setImage,s=e.image,n=function(e){e.images,e.setImages;return Object(j.jsxs)("div",{className:"tile is-child image-item",children:[Object(j.jsx)("span",{className:"is-small button is-inverted is-danger delete-image",title:"Remove",onClick:function(e){t(null)},children:Object(j.jsx)("i",{className:"far fa-trash-alt"})}),Object(j.jsx)("img",{src:URL.createObjectURL(s),alt:"Could not load"})]})};return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"file is-centered is-boxed has-name",children:Object(j.jsxs)("label",{className:"file-label",children:[Object(j.jsx)("input",{className:"file-input",src:"./LocalsOnly.png",type:"file",name:"images",onChange:function(e){e.preventDefault();var a=e.target.files;console.dir(a[0]),t(a[0])}}),Object(j.jsx)(d.a,{avatar:a.getAvatar()})]})}),s&&Object(j.jsx)(n,{})]})}));a.b=function(e){var a=e.folder,t=e.multiple,s=e.callback,o=Object(r.useState)(!1),d=Object(l.a)(o,2),u=d[0],b=d[1],m=Object(r.useState)([]),h=Object(l.a)(m,2),p=h[0],f=h[1],O=function(){var e=Object(c.a)(n.a.mark((function e(t){var i,l,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(p),i=new FormData,b(!0),l=p.map(function(){var e=Object(c.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.append("file",t),i.append("upload_preset","".concat(a,"_images")),e.next=4,fetch("https://api.cloudinary.com/v1_1/dpjlvg7ql/image/upload",{method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){var a=e.public_id;return console.log(a),a}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()),e.next=7,Promise.all(l);case 7:r=e.sent,s(r),b(!1);case 10:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),x=function(e){var a=e.images,t=e.setImages,s=function(e){e.persist();var s=Number(e.target.id);console.log("Image name: "+s);var n=a[s].name;t(a.filter((function(e){return e.name!==n})))};return Object(j.jsx)("div",{className:"tile is-ancestor",children:Object(j.jsx)("div",{className:"tile is-parent image-row",children:a&&a.map((function(e,a){return Object(j.jsxs)("div",{className:"tile is-child image-item",children:[Object(j.jsx)("span",{className:"is-small button is-inverted is-danger delete-image",title:"Remove",id:a,onClick:s,children:Object(j.jsx)("i",{className:"far fa-trash-alt"})}),Object(j.jsx)("img",{src:URL.createObjectURL(e),alt:"Could not load"})]},a)}))})})};return Object(j.jsxs)("form",{onSubmit:O,className:"form-container",children:[Object(j.jsx)("div",{className:"file is-centered is-boxed has-name",children:Object(j.jsxs)("label",{className:"file-label",children:[Object(j.jsx)("input",{className:"file-input",multiple:t,type:"file",name:"images",onChange:function(e){e.preventDefault();var a=e.target.files;f(t?function(e){return[].concat(Object(i.a)(e),Object(i.a)(a))}:Object(i.a)(a))}}),Object(j.jsxs)("span",{className:"file-cta",children:[Object(j.jsx)("span",{className:"file-icon",children:Object(j.jsx)("i",{className:"fas fa-images"})}),Object(j.jsx)("span",{className:"file-label",children:"Get images"})]})]})}),Object(j.jsxs)("div",{className:"buttons is-centered section",children:[Object(j.jsx)("button",{type:"submit",className:"button is-success",children:"Upload"}),Object(j.jsx)("button",{type:"submit",className:"button is-danger",onClick:function(e){e.preventDefault(),f([])},children:"Remove all"})]}),u?Object(j.jsx)("div",{children:"Loading..."}):Object(j.jsx)(x,{images:p,setImages:f})]})}},378:function(e,a,t){"use strict";t.r(a);var s=t(27),n=t(8),c=t(12),i=t.n(c),l=t(20),r=t(7),o=t(1),d=t(193),j=t(24),u=t.n(j),b=t(29),m=t(17),h=t(10),p=t(30),f=t(19),O=t(0),x=Object(m.c)(Object(b.c)((function(e){var a=e.history,t=e.firebase,c=e.user,j=c.getLocalTo().split(":"),b=Object(r.a)(j,2),m=b[0],x=b[1],v=Object(o.useState)(!1),g=Object(r.a)(v,2),N=g[0],w=g[1],y=Object(o.useState)(!0),C=Object(r.a)(y,2),k=C[0],P=C[1],D=Object(p.a)(!1),L=Object(r.a)(D,2),S=L[0],I=L[1],_=void 0!==Object(f.g)("local-update"),E=Object(o.useState)(null),F=Object(r.a)(E,2),U=F[0],q=F[1],R=Object(o.useState)({name:c.getName()||"",email:c.getEmail()||"",handler:c.getHandler()||"",city:x.charAt(0).toUpperCase()+x.slice(1)||"",state:m.toUpperCase()||"",oldPassword:"",newPassword:""}),T=Object(r.a)(R,2),H=T[0],A=T[1],M=Object(o.useCallback)(Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(!0),!(H.handler.includes(" ")||""===H.handler||H.handler.length<4)){e.next=3;break}return e.abrupt("return",P(!1));case 3:if(H.handler!==c.getHandler()){e.next=5;break}return e.abrupt("return",P(!0));case 5:return e.next=7,u.a.get("/api/v1/users/handles/".concat(H.handler)).then((function(e){return console.dir(e),P(!0)})).catch((function(e){return console.log("In Handle Check: "+e),P(!1)}));case 7:case"end":return e.stop()}}),e)}))),[H.handler,c]);Object(o.useEffect)((function(){H.handler!==c.getHandler()&&M().then((function(){return w(!1)}))}),[M,H.handler,c]);var J=function(){var e=Object(l.a)(i.a.mark((function e(s){var n,r,o,d,j,b,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),c.getEmail()===H.email){e.next=4;break}return e.next=4,t.updateEmail(H.email).then(function(){var e=Object(l.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Email updated"),e.next=3,u.a.patch("/api/v1/users/".concat(c.getID(),"/email"),{email:H.email});case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error updating email from edit user page"),console.dir(e)}));case 4:if(c.getName()===H.name){e.next=7;break}return e.next=7,u.a.patch("/api/v1/users/".concat(c.getID(),"/name"),{name:H.name});case 7:if(c.getHandler()===H.handler){e.next=10;break}return e.next=10,u.a.patch("/api/v1/users/".concat(c.getID(),"/handle"),{handle:H.handler});case 10:if(!(H.newPassword.length>=6&&H.newPassword!==H.oldPassword)){e.next=15;break}return console.log("Changing password"),n=t.emailCredentials(H.email,H.oldPassword),e.next=15,t.reauth(n).then((function(e){console.log("Re-authenticated"),t.updatePassword(H.newPassword).then((function(e){console.log("New password set")})).catch((function(e){console.log("Error setting new password: "+e)}))})).catch(console.dir);case 15:if(!U){e.next=21;break}return(r=new FormData).append("file",U),r.append("upload_preset","avatar_images"),e.next=21,fetch("https://api.cloudinary.com/v1_1/dpjlvg7ql/image/upload",{method:"POST",body:r}).then((function(e){return e.json()})).then((function(e){var a=e.public_id;return console.log(a),a})).then(function(){var e=Object(l.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.patch("/api/v1/users/".concat(c.getID(),"/avatar"),{avatar:a}).then((function(e){console.dir("Updated Avatar: "+e)}));case 2:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}());case 21:H.state.toLowerCase()===m.toLowerCase()&&H.city.toLowerCase()===x.toLowerCase()||(o=H.state.toLowerCase()+":"+H.city.toLowerCase().replace(" ","-"),Object(f.h)("local-update",o,1e3),(d=new Date).setTime(d.getTime()+2592e6),j=d.toUTCString(),Object(f.h)("local-update-on",j,30),b=Object(f.g)("local-update-on"),h=new Date(b),console.log(h.getDate())),alert("Your profile has been updated!"),a.push("/dashboard");case 24:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Y=function(){return!0===N?Object(O.jsx)("span",{className:"icon is-small is-right has-text-info",children:Object(O.jsx)("i",{className:"fas fa-circle-notch fa-pulse"})}):k?Object(O.jsx)("span",{className:"icon is-small is-right has-text-success",children:Object(O.jsx)("i",{className:"fas fa-check"})}):Object(O.jsx)("span",{className:"icon is-small is-right has-text-danger",children:Object(O.jsx)("i",{className:"fas fa-times"})})},B=function(e){e.preventDefault();var a=e.target,t=a.name,c=a.value;A("password"===t?Object(n.a)(Object(n.a)({},H),{},Object(s.a)({},t,c.replace(" ",""))):Object(n.a)(Object(n.a)({},H),{},Object(s.a)({},t,c)))},G=function(){var e=new Date(Object(f.g)("local-update-on")),a=new Date,t=Math.abs(e-a),s=Math.ceil(t/864e5);return s=s<=1||isNaN(s)?"today":"in "+s+" days",Object(O.jsx)("span",{children:s})};return Object(O.jsxs)("main",{id:"avatar-upload-page",className:"section mt-4 container",children:[Object(O.jsx)("div",{className:"columns is-centered",children:Object(O.jsx)("h1",{className:"title column has-text-centered my-3",children:"Edit Profile"})}),Object(O.jsx)("form",{onSubmit:J,className:"",children:Object(O.jsxs)("section",{className:"section container box columns",children:[Object(O.jsx)("div",{className:"column",children:Object(O.jsx)(d.a,{setImage:q,image:U})}),Object(O.jsxs)("div",{className:"column",children:[Object(O.jsxs)("div",{className:"field",children:[Object(O.jsx)("label",{htmlFor:"name",children:"Name"}),Object(O.jsxs)("div",{className:"control has-icons-left",children:[Object(O.jsx)("input",{type:"text",name:"name",value:H.name,className:"input",onChange:B,required:!0}),Object(O.jsx)("span",{className:"icon is-small is-left",children:Object(O.jsx)("i",{className:"fas fa-user"})})]})]}),Object(O.jsxs)("div",{className:"field",children:[Object(O.jsx)("label",{htmlFor:"handler",children:"Handler"}),Object(O.jsxs)("div",{className:"control has-icons-left has-icons-right",children:[Object(O.jsx)("input",{type:"text",name:"handler",value:H.handler,className:"input",onChange:B,minLength:4,required:!0}),Object(O.jsx)("span",{className:"icon is-small is-left",children:Object(O.jsx)("i",{className:"fas fa-at"})}),Object(O.jsx)(Y,{})]})]}),Object(O.jsxs)("div",{className:"field",children:[Object(O.jsx)("label",{htmlFor:"email",children:"Email"}),Object(O.jsxs)("div",{className:"control has-icons-left",children:[Object(O.jsx)("input",{type:"text",name:"email",value:H.email,className:"input",onChange:B,required:!0}),Object(O.jsx)("span",{className:"icon is-small is-left",children:Object(O.jsx)("i",{className:"fas fa-envelope"})})]})]}),Object(O.jsxs)("div",{className:"field",children:[Object(O.jsx)("label",{htmlFor:"email",children:"Old Password"}),Object(O.jsxs)("div",{className:"control has-icons-left has-icons-right",children:[Object(O.jsx)("input",{type:S?"text":"password",name:"oldPassword",value:H.oldPassword,className:"input",onChange:B}),Object(O.jsx)("span",{className:"icon is-small is-left",children:Object(O.jsx)("i",{className:"fas fa-key"})}),Object(O.jsx)("span",{className:"icon password-visible-icon is-small is-right",onClick:I,children:S?Object(O.jsx)("i",{className:"fas fa-eye"}):Object(O.jsx)("i",{className:"fas fa-eye-slash"})})]})]}),Object(O.jsxs)("div",{className:"field",children:[Object(O.jsx)("label",{htmlFor:"email",children:"New Password"}),Object(O.jsxs)("div",{className:"control has-icons-left has-icons-right",children:[Object(O.jsx)("input",{type:S?"text":"password",autoComplete:"new-password",name:"newPassword",value:H.newPassword,className:"input",onChange:B}),Object(O.jsx)("span",{className:"icon is-small is-left",children:Object(O.jsx)("i",{className:"fas fa-key"})}),Object(O.jsx)("span",{className:"icon password-visible-icon is-small is-right",onClick:I,children:S?Object(O.jsx)("i",{className:"fas fa-eye"}):Object(O.jsx)("i",{className:"fas fa-eye-slash"})})]})]}),Object(O.jsxs)("div",{className:"field",children:[Object(O.jsx)("label",{htmlFor:"local",children:"City/Town"}),_&&Object(O.jsxs)("span",{className:"pl-2 has-text-danger",children:["Your local will update ",Object(O.jsx)(G,{})]}),Object(O.jsx)("div",{name:"local",className:"control",children:Object(O.jsx)("input",{type:"text",name:"city",value:H.city,className:"input",onChange:B,required:!0,disabled:_})}),Object(O.jsx)("label",{htmlFor:"local",children:"State"}),Object(O.jsx)("div",{className:"control",children:Object(O.jsx)("input",{type:"text",name:"state",value:H.state,className:"input",onChange:B,required:!0,minLength:2,maxLength:2,disabled:_})})]}),Object(O.jsx)("div",{className:"level",children:Object(O.jsxs)("div",{className:"level-left buttons ",children:[Object(O.jsx)("button",{className:"button is-success",disabled:!k,children:"Submit"}),Object(O.jsx)(h.b,{className:"button is-danger",to:"/dashboard",children:"Cancel"})]})})]})]})})]})})));a.default=x}}]);
//# sourceMappingURL=8.980c3850.chunk.js.map